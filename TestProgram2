using CafeWinApp.Data;
using CafeWinApp.Models;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

namespace CafeWinApp
{
    public partial class MainForm : Form
    {
        private ProductRepository _repo;

        public MainForm()
        {
            InitializeComponent();
            _repo = new ProductRepository();
            LoadProductList();
        }

        private void LoadProductList(List<Product>? data = null)
        {
            var list = data ?? _repo.GetAll();

            dgvProducts.Rows.Clear();

            foreach (var p in list)
            {
                dgvProducts.Rows.Add(
                    p.Id,
                    p.Name,
                    p.Size,
                    p.Category,
                    p.Price,
                    p.Description
                );
            }

            lblCount.Text = $"Tổng sản phẩm: {list.Count}";
        }

        private void btnAdd_Click(object sender, EventArgs e)
        {
            ProductForm f = new ProductForm(null, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnEdit_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để sửa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);
            Product p = _repo.GetById(id);

            ProductForm f = new ProductForm(p, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnDelete_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để xóa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);

            var confirm = MessageBox.Show(
                "Bạn có chắc chắn muốn xóa sản phẩm này?",
                "Xác nhận",
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning
            );

            if (confirm == DialogResult.Yes)
            {
                try
                {
                    _repo.Delete(id);
                    LoadProductList();
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.Message);
                }
            }
        }

        private void txtSearch_TextChanged(object sender, EventArgs e)
        {
            string keyword = txtSearch.Text.Trim();
            if (keyword == "")
            {
                LoadProductList();
                return;
            }

            var result = _repo.Search(keyword);
            LoadProductList(result);
        }

        private void btnSortName_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByName();
            LoadProductList(sorted);
        }

        private void btnSortPrice_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByPrice();
            LoadProductList(sorted);
        }

        private void btnRefresh_Click(object sender, EventArgs e)
        {
            txtSearch.Text = "";
            LoadProductList();
        }
    }
}using CafeWinApp.Data;
using CafeWinApp.Models;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

namespace CafeWinApp
{
    public partial class MainForm : Form
    {
        private ProductRepository _repo;

        public MainForm()
        {
            InitializeComponent();
            _repo = new ProductRepository();
            LoadProductList();
        }

        private void LoadProductList(List<Product>? data = null)
        {
            var list = data ?? _repo.GetAll();

            dgvProducts.Rows.Clear();

            foreach (var p in list)
            {
                dgvProducts.Rows.Add(
                    p.Id,
                    p.Name,
                    p.Size,
                    p.Category,
                    p.Price,
                    p.Description
                );
            }

            lblCount.Text = $"Tổng sản phẩm: {list.Count}";
        }

        private void btnAdd_Click(object sender, EventArgs e)
        {
            ProductForm f = new ProductForm(null, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnEdit_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để sửa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);
            Product p = _repo.GetById(id);

            ProductForm f = new ProductForm(p, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnDelete_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để xóa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);

            var confirm = MessageBox.Show(
                "Bạn có chắc chắn muốn xóa sản phẩm này?",
                "Xác nhận",
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning
            );

            if (confirm == DialogResult.Yes)
            {
                try
                {
                    _repo.Delete(id);
                    LoadProductList();
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.Message);
                }
            }
        }

        private void txtSearch_TextChanged(object sender, EventArgs e)
        {
            string keyword = txtSearch.Text.Trim();
            if (keyword == "")
            {
                LoadProductList();
                return;
            }

            var result = _repo.Search(keyword);
            LoadProductList(result);
        }

        private void btnSortName_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByName();
            LoadProductList(sorted);
        }

        private void btnSortPrice_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByPrice();
            LoadProductList(sorted);
        }

        private void btnRefresh_Click(object sender, EventArgs e)
        {
            txtSearch.Text = "";
            LoadProductList();
        }
    }
}
using CafeWinApp.Data;
using CafeWinApp.Models;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

namespace CafeWinApp
{
    public partial class MainForm : Form
    {
        private ProductRepository _repo;

        public MainForm()
        {
            InitializeComponent();
            _repo = new ProductRepository();
            LoadProductList();
        }

        private void LoadProductList(List<Product>? data = null)
        {
            var list = data ?? _repo.GetAll();

            dgvProducts.Rows.Clear();

            foreach (var p in list)
            {
                dgvProducts.Rows.Add(
                    p.Id,
                    p.Name,
                    p.Size,
                    p.Category,
                    p.Price,
                    p.Description
                );
            }

            lblCount.Text = $"Tổng sản phẩm: {list.Count}";
        }

        private void btnAdd_Click(object sender, EventArgs e)
        {
            ProductForm f = new ProductForm(null, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnEdit_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để sửa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);
            Product p = _repo.GetById(id);

            ProductForm f = new ProductForm(p, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnDelete_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để xóa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);

            var confirm = MessageBox.Show(
                "Bạn có chắc chắn muốn xóa sản phẩm này?",
                "Xác nhận",
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning
            );

            if (confirm == DialogResult.Yes)
            {
                try
                {
                    _repo.Delete(id);
                    LoadProductList();
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.Message);
                }
            }
        }

        private void txtSearch_TextChanged(object sender, EventArgs e)
        {
            string keyword = txtSearch.Text.Trim();
            if (keyword == "")
            {
                LoadProductList();
                return;
            }

            var result = _repo.Search(keyword);
            LoadProductList(result);
        }

        private void btnSortName_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByName();
            LoadProductList(sorted);
        }

        private void btnSortPrice_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByPrice();
            LoadProductList(sorted);
        }

        private void btnRefresh_Click(object sender, EventArgs e)
        {
            txtSearch.Text = "";
            LoadProductList();
        }
    }
}
using CafeWinApp.Data;
using CafeWinApp.Models;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

namespace CafeWinApp
{
    public partial class MainForm : Form
    {
        private ProductRepository _repo;

        public MainForm()
        {
            InitializeComponent();
            _repo = new ProductRepository();
            LoadProductList();
        }

        private void LoadProductList(List<Product>? data = null)
        {
            var list = data ?? _repo.GetAll();

            dgvProducts.Rows.Clear();

            foreach (var p in list)
            {
                dgvProducts.Rows.Add(
                    p.Id,
                    p.Name,
                    p.Size,
                    p.Category,
                    p.Price,
                    p.Description
                );
            }

            lblCount.Text = $"Tổng sản phẩm: {list.Count}";
        }

        private void btnAdd_Click(object sender, EventArgs e)
        {
            ProductForm f = new ProductForm(null, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnEdit_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để sửa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);
            Product p = _repo.GetById(id);

            ProductForm f = new ProductForm(p, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnDelete_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để xóa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);

            var confirm = MessageBox.Show(
                "Bạn có chắc chắn muốn xóa sản phẩm này?",
                "Xác nhận",
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning
            );

            if (confirm == DialogResult.Yes)
            {
                try
                {
                    _repo.Delete(id);
                    LoadProductList();
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.Message);
                }
            }
        }

        private void txtSearch_TextChanged(object sender, EventArgs e)
        {
            string keyword = txtSearch.Text.Trim();
            if (keyword == "")
            {
                LoadProductList();
                return;
            }

            var result = _repo.Search(keyword);
            LoadProductList(result);
        }

        private void btnSortName_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByName();
            LoadProductList(sorted);
        }

        private void btnSortPrice_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByPrice();
            LoadProductList(sorted);
        }

        private void btnRefresh_Click(object sender, EventArgs e)
        {
            txtSearch.Text = "";
            LoadProductList();
        }
    }
}
using CafeWinApp.Data;
using CafeWinApp.Models;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

namespace CafeWinApp
{
    public partial class MainForm : Form
    {
        private ProductRepository _repo;

        public MainForm()
        {
            InitializeComponent();
            _repo = new ProductRepository();
            LoadProductList();
        }

        private void LoadProductList(List<Product>? data = null)
        {
            var list = data ?? _repo.GetAll();

            dgvProducts.Rows.Clear();

            foreach (var p in list)
            {
                dgvProducts.Rows.Add(
                    p.Id,
                    p.Name,
                    p.Size,
                    p.Category,
                    p.Price,
                    p.Description
                );
            }

            lblCount.Text = $"Tổng sản phẩm: {list.Count}";
        }

        private void btnAdd_Click(object sender, EventArgs e)
        {
            ProductForm f = new ProductForm(null, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnEdit_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để sửa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);
            Product p = _repo.GetById(id);

            ProductForm f = new ProductForm(p, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnDelete_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để xóa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);

            var confirm = MessageBox.Show(
                "Bạn có chắc chắn muốn xóa sản phẩm này?",
                "Xác nhận",
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning
            );

            if (confirm == DialogResult.Yes)
            {
                try
                {
                    _repo.Delete(id);
                    LoadProductList();
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.Message);
                }
            }
        }

        private void txtSearch_TextChanged(object sender, EventArgs e)
        {
            string keyword = txtSearch.Text.Trim();
            if (keyword == "")
            {
                LoadProductList();
                return;
            }

            var result = _repo.Search(keyword);
            LoadProductList(result);
        }

        private void btnSortName_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByName();
            LoadProductList(sorted);
        }

        private void btnSortPrice_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByPrice();
            LoadProductList(sorted);
        }

        private void btnRefresh_Click(object sender, EventArgs e)
        {
            txtSearch.Text = "";
            LoadProductList();
        }
    }
}
using CafeWinApp.Data;
using CafeWinApp.Models;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

namespace CafeWinApp
{
    public partial class MainForm : Form
    {
        private ProductRepository _repo;

        public MainForm()
        {
            InitializeComponent();
            _repo = new ProductRepository();
            LoadProductList();
        }

        private void LoadProductList(List<Product>? data = null)
        {
            var list = data ?? _repo.GetAll();

            dgvProducts.Rows.Clear();

            foreach (var p in list)
            {
                dgvProducts.Rows.Add(
                    p.Id,
                    p.Name,
                    p.Size,
                    p.Category,
                    p.Price,
                    p.Description
                );
            }

            lblCount.Text = $"Tổng sản phẩm: {list.Count}";
        }

        private void btnAdd_Click(object sender, EventArgs e)
        {
            ProductForm f = new ProductForm(null, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnEdit_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để sửa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);
            Product p = _repo.GetById(id);

            ProductForm f = new ProductForm(p, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnDelete_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để xóa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);

            var confirm = MessageBox.Show(
                "Bạn có chắc chắn muốn xóa sản phẩm này?",
                "Xác nhận",
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning
            );

            if (confirm == DialogResult.Yes)
            {
                try
                {
                    _repo.Delete(id);
                    LoadProductList();
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.Message);
                }
            }
        }

        private void txtSearch_TextChanged(object sender, EventArgs e)
        {
            string keyword = txtSearch.Text.Trim();
            if (keyword == "")
            {
                LoadProductList();
                return;
            }

            var result = _repo.Search(keyword);
            LoadProductList(result);
        }

        private void btnSortName_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByName();
            LoadProductList(sorted);
        }

        private void btnSortPrice_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByPrice();
            LoadProductList(sorted);
        }

        private void btnRefresh_Click(object sender, EventArgs e)
        {
            txtSearch.Text = "";
            LoadProductList();
        }
    }
}
using CafeWinApp.Data;
using CafeWinApp.Models;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

namespace CafeWinApp
{
    public partial class MainForm : Form
    {
        private ProductRepository _repo;

        public MainForm()
        {
            InitializeComponent();
            _repo = new ProductRepository();
            LoadProductList();
        }

        private void LoadProductList(List<Product>? data = null)
        {
            var list = data ?? _repo.GetAll();

            dgvProducts.Rows.Clear();

            foreach (var p in list)
            {
                dgvProducts.Rows.Add(
                    p.Id,
                    p.Name,
                    p.Size,
                    p.Category,
                    p.Price,
                    p.Description
                );
            }

            lblCount.Text = $"Tổng sản phẩm: {list.Count}";
        }

        private void btnAdd_Click(object sender, EventArgs e)
        {
            ProductForm f = new ProductForm(null, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnEdit_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để sửa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);
            Product p = _repo.GetById(id);

            ProductForm f = new ProductForm(p, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnDelete_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để xóa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);

            var confirm = MessageBox.Show(
                "Bạn có chắc chắn muốn xóa sản phẩm này?",
                "Xác nhận",
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning
            );

            if (confirm == DialogResult.Yes)
            {
                try
                {
                    _repo.Delete(id);
                    LoadProductList();
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.Message);
                }
            }
        }

        private void txtSearch_TextChanged(object sender, EventArgs e)
        {
            string keyword = txtSearch.Text.Trim();
            if (keyword == "")
            {
                LoadProductList();
                return;
            }

            var result = _repo.Search(keyword);
            LoadProductList(result);
        }

        private void btnSortName_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByName();
            LoadProductList(sorted);
        }

        private void btnSortPrice_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByPrice();
            LoadProductList(sorted);
        }

        private void btnRefresh_Click(object sender, EventArgs e)
        {
            txtSearch.Text = "";
            LoadProductList();
        }
    }
}
using CafeWinApp.Data;
using CafeWinApp.Models;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

namespace CafeWinApp
{
    public partial class MainForm : Form
    {
        private ProductRepository _repo;

        public MainForm()
        {
            InitializeComponent();
            _repo = new ProductRepository();
            LoadProductList();
        }

        private void LoadProductList(List<Product>? data = null)
        {
            var list = data ?? _repo.GetAll();

            dgvProducts.Rows.Clear();

            foreach (var p in list)
            {
                dgvProducts.Rows.Add(
                    p.Id,
                    p.Name,
                    p.Size,
                    p.Category,
                    p.Price,
                    p.Description
                );
            }

            lblCount.Text = $"Tổng sản phẩm: {list.Count}";
        }

        private void btnAdd_Click(object sender, EventArgs e)
        {
            ProductForm f = new ProductForm(null, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnEdit_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để sửa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);
            Product p = _repo.GetById(id);

            ProductForm f = new ProductForm(p, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnDelete_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để xóa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);

            var confirm = MessageBox.Show(
                "Bạn có chắc chắn muốn xóa sản phẩm này?",
                "Xác nhận",
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning
            );

            if (confirm == DialogResult.Yes)
            {
                try
                {
                    _repo.Delete(id);
                    LoadProductList();
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.Message);
                }
            }
        }

        private void txtSearch_TextChanged(object sender, EventArgs e)
        {
            string keyword = txtSearch.Text.Trim();
            if (keyword == "")
            {
                LoadProductList();
                return;
            }

            var result = _repo.Search(keyword);
            LoadProductList(result);
        }

        private void btnSortName_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByName();
            LoadProductList(sorted);
        }

        private void btnSortPrice_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByPrice();
            LoadProductList(sorted);
        }

        private void btnRefresh_Click(object sender, EventArgs e)
        {
            txtSearch.Text = "";
            LoadProductList();
        }
    }
}
using CafeWinApp.Data;
using CafeWinApp.Models;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

namespace CafeWinApp
{
    public partial class MainForm : Form
    {
        private ProductRepository _repo;

        public MainForm()
        {
            InitializeComponent();
            _repo = new ProductRepository();
            LoadProductList();
        }

        private void LoadProductList(List<Product>? data = null)
        {
            var list = data ?? _repo.GetAll();

            dgvProducts.Rows.Clear();

            foreach (var p in list)
            {
                dgvProducts.Rows.Add(
                    p.Id,
                    p.Name,
                    p.Size,
                    p.Category,
                    p.Price,
                    p.Description
                );
            }

            lblCount.Text = $"Tổng sản phẩm: {list.Count}";
        }

        private void btnAdd_Click(object sender, EventArgs e)
        {
            ProductForm f = new ProductForm(null, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnEdit_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để sửa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);
            Product p = _repo.GetById(id);

            ProductForm f = new ProductForm(p, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnDelete_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để xóa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);

            var confirm = MessageBox.Show(
                "Bạn có chắc chắn muốn xóa sản phẩm này?",
                "Xác nhận",
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning
            );

            if (confirm == DialogResult.Yes)
            {
                try
                {
                    _repo.Delete(id);
                    LoadProductList();
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.Message);
                }
            }
        }

        private void txtSearch_TextChanged(object sender, EventArgs e)
        {
            string keyword = txtSearch.Text.Trim();
            if (keyword == "")
            {
                LoadProductList();
                return;
            }

            var result = _repo.Search(keyword);
            LoadProductList(result);
        }

        private void btnSortName_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByName();
            LoadProductList(sorted);
        }

        private void btnSortPrice_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByPrice();
            LoadProductList(sorted);
        }

        private void btnRefresh_Click(object sender, EventArgs e)
        {
            txtSearch.Text = "";
            LoadProductList();
        }
    }
}
using CafeWinApp.Data;
using CafeWinApp.Models;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

namespace CafeWinApp
{
    public partial class MainForm : Form
    {
        private ProductRepository _repo;

        public MainForm()
        {
            InitializeComponent();
            _repo = new ProductRepository();
            LoadProductList();
        }

        private void LoadProductList(List<Product>? data = null)
        {
            var list = data ?? _repo.GetAll();

            dgvProducts.Rows.Clear();

            foreach (var p in list)
            {
                dgvProducts.Rows.Add(
                    p.Id,
                    p.Name,
                    p.Size,
                    p.Category,
                    p.Price,
                    p.Description
                );
            }

            lblCount.Text = $"Tổng sản phẩm: {list.Count}";
        }

        private void btnAdd_Click(object sender, EventArgs e)
        {
            ProductForm f = new ProductForm(null, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnEdit_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để sửa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);
            Product p = _repo.GetById(id);

            ProductForm f = new ProductForm(p, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnDelete_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để xóa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);

            var confirm = MessageBox.Show(
                "Bạn có chắc chắn muốn xóa sản phẩm này?",
                "Xác nhận",
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning
            );

            if (confirm == DialogResult.Yes)
            {
                try
                {
                    _repo.Delete(id);
                    LoadProductList();
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.Message);
                }
            }
        }

        private void txtSearch_TextChanged(object sender, EventArgs e)
        {
            string keyword = txtSearch.Text.Trim();
            if (keyword == "")
            {
                LoadProductList();
                return;
            }

            var result = _repo.Search(keyword);
            LoadProductList(result);
        }

        private void btnSortName_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByName();
            LoadProductList(sorted);
        }

        private void btnSortPrice_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByPrice();
            LoadProductList(sorted);
        }

        private void btnRefresh_Click(object sender, EventArgs e)
        {
            txtSearch.Text = "";
            LoadProductList();
        }
    }
}
using CafeWinApp.Data;
using CafeWinApp.Models;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

namespace CafeWinApp
{
    public partial class MainForm : Form
    {
        private ProductRepository _repo;

        public MainForm()
        {
            InitializeComponent();
            _repo = new ProductRepository();
            LoadProductList();
        }

        private void LoadProductList(List<Product>? data = null)
        {
            var list = data ?? _repo.GetAll();

            dgvProducts.Rows.Clear();

            foreach (var p in list)
            {
                dgvProducts.Rows.Add(
                    p.Id,
                    p.Name,
                    p.Size,
                    p.Category,
                    p.Price,
                    p.Description
                );
            }

            lblCount.Text = $"Tổng sản phẩm: {list.Count}";
        }

        private void btnAdd_Click(object sender, EventArgs e)
        {
            ProductForm f = new ProductForm(null, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnEdit_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để sửa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);
            Product p = _repo.GetById(id);

            ProductForm f = new ProductForm(p, _repo);
            if (f.ShowDialog() == DialogResult.OK)
                LoadProductList();
        }

        private void btnDelete_Click(object sender, EventArgs e)
        {
            if (dgvProducts.SelectedRows.Count == 0)
            {
                MessageBox.Show("Hãy chọn sản phẩm để xóa.");
                return;
            }

            int id = Convert.ToInt32(dgvProducts.SelectedRows[0].Cells[0].Value);

            var confirm = MessageBox.Show(
                "Bạn có chắc chắn muốn xóa sản phẩm này?",
                "Xác nhận",
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning
            );

            if (confirm == DialogResult.Yes)
            {
                try
                {
                    _repo.Delete(id);
                    LoadProductList();
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.Message);
                }
            }
        }

        private void txtSearch_TextChanged(object sender, EventArgs e)
        {
            string keyword = txtSearch.Text.Trim();
            if (keyword == "")
            {
                LoadProductList();
                return;
            }

            var result = _repo.Search(keyword);
            LoadProductList(result);
        }

        private void btnSortName_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByName();
            LoadProductList(sorted);
        }

        private void btnSortPrice_Click(object sender, EventArgs e)
        {
            var sorted = _repo.SortByPrice();
            LoadProductList(sorted);
        }

        private void btnRefresh_Click(object sender, EventArgs e)
        {
            txtSearch.Text = "";
            LoadProductList();
        }
    }
}

